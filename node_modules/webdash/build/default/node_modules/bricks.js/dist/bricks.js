(function(a,b){'object'===typeof exports&&'undefined'!==typeof module?module.exports=b():'function'===typeof define&&define.amd?define(b):a.Bricks=b()})(this,function(){'use strict';var a=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},b=function(){function b(a,b){return e[a]=e[a]||[],e[a].push(b),this}function c(a){var b=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return b?e[a].splice(e[a].indexOf(b),1):delete e[a],this}var d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},e=Object.create(null);return a({},d,{on:b,once:function(a,c){return c._once=!0,b(a,c),this},off:c,emit:function(a){for(var b=this,d=arguments.length,f=Array(1<d?d-1:0),g=1;g<d;g++)f[g-1]=arguments[g];var h=e[a]&&e[a].slice();return h&&h.forEach(function(d){d._once&&c(a,d),d.apply(b,f)}),this}})};return function(){function a(a){a.forEach(function(a){return a()})}function c(a){1<arguments.length&&arguments[1]!==void 0?arguments[1]:document;return Array.prototype.slice.call(a)}function d(a){return Array.apply(null,Array(a)).map(function(){return 0})}function e(){return x.map(function(a){return a.mq&&window.matchMedia('(min-width: '+a.mq+')').matches}).indexOf(!0)}function f(){j||(window.requestAnimationFrame(g),j=!0)}function g(){k!==e()&&(h(),D.emit('resize',l)),j=!1}function h(){return i=!1,a(B.concat(C)),D.emit('pack')}var i,j,k,l,m,n,o,p,q,r,s,t,u,v=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},w=0===v.packed.indexOf('data-')?v.packed:'data-'+v.packed,x=v.sizes.slice().reverse(),y=!1!==v.position,z=v.container.nodeType?v.container:document.querySelector(v.container),A={all:function(){return c(z.children)},new:function(){return c(z.children).filter(function(a){return!a.hasAttribute(''+w)})}},B=[function(){k=e()},function(){l=-1===k?x[x.length-1]:x[k]},function(){n=d(l.columns)}],C=[function(){s=A[i?'new':'all']()},function(){0===s.length||(t=s.map(function(a){return a.clientWidth}),u=s.map(function(a){return a.clientHeight}))},function(){s.forEach(function(a,b){m=n.indexOf(Math.min.apply(Math,n)),a.style.position='absolute',o=n[m]+'px',p=m*t[b]+m*l.gutter+'px',y?(a.style.top=o,a.style.left=p):a.style.transform='translate3d('+p+', '+o+', 0)',a.setAttribute(w,''),q=t[b],r=u[b],q&&r&&(n[m]+=r+l.gutter)})},function(){z.style.position='relative',z.style.width=l.columns*q+(l.columns-1)*l.gutter+'px',z.style.height=Math.max.apply(Math,n)-l.gutter+'px'}],D=b({pack:h,update:function(){return i=!0,a(C),D.emit('update')},resize:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,b=a?'addEventListener':'removeEventListener';return window[b]('resize',f),D}});return D}});